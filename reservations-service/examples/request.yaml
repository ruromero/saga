sagaDefinition:
  id: tripReservation
  version: v1
  name: Trip reservation
  receive:
    from: trip-reservations
  reply:
    to: trip-reservations-result
    errorTo: trip-reservations-failed
  steps:
    - parallel:
        - step:
            name: Book Hotel
            message: BookHotel
            send:
              to: book-reservations
            expect:
              from: book-reservations-success
              errorFrom: book-reservations-failed
            compensate:
              to: book-cancellations
            waitFor: T02M
        - step:
            name: Rent Car
            message: ReserveCar
            send:
              to: car-reservations
            expect:
              from: car-reservations-success
              errorFrom: car-reservations-failed
            compensateWith:
              to: car-cancellations
            waitFor: T02M
    - step:
        - name: Process Payment
          message: ProcessPayment
          send:
            to: payment-requests
          expect:
            from: payment-requests-success
            errorFrom: payment-requests-failed
          waitFor: T10M